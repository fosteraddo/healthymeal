"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[66558],{737672:function(e,t,n){n.d(t,{m:function(){return _}});var o,i,r=n(827378),u=n(456552),c=n(567921),s=n.n(c),a=n(686677),l=n(865051),f=n(74186),d=n(221527),p=n(951730),h=function(e){var t=e.voucherCode,n=e.productSkus,o=e.locale,i=e.systemCountry,r=e.discountCommunicationId;return[p.Z["price-presentation.discountCommunication"],function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({voucherCode:t,productSkus:n,locale:o,systemCountry:i},r&&{discountCommunicationId:r})]};function v(e,t,n,o,i,r,u){try{var c=e[r](u),s=c.value}catch(e){n(e);return}c.done?t(s):Promise.resolve(s).then(o,i)}var b=function(e,t){var n,o,i,r,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(r){return function(c){return function(r){if(n)throw TypeError("Generator is already executing.");for(;u;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,o=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){u.label=r[1];break}if(6===r[0]&&u.label<i[1]){u.label=i[1],i=r;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(r);break}i[2]&&u.ops.pop(),u.trys.pop();continue}r=t.call(e,u)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,c])}}},m=(o=function(e,t){var n,o,i,r,u,c,s=arguments;return b(this,function(a){switch(a.label){case 0:return n=e.voucherCode,o=e.productSkus,i=e.systemCountry,r=e.locale,u=e.parentSpan,c=e.discountCommunicationId,[4,(s.length>2&&void 0!==s[2]?s[2]:l.Z)("/price-presentation/discount_communication/voucher/".concat(n),t,{query:{country:i,locale:r,skus:o.join(","),dc_id:c||""},parentSpan:u})];case 1:return[2,a.sent().json()]}})},i=function(){var e=this,t=arguments;return new Promise(function(n,i){var r=o.apply(e,t);function u(e){v(r,n,i,u,c,"next",e)}function c(e){v(r,n,i,u,c,"throw",e)}u(void 0)})},function(e,t){return i.apply(this,arguments)}),_=function(e,t){var n,o,i=(0,a.useRouter)().query.discount_comm_id,c=(0,r.useMemo)(function(){return s().get("hf_discount_comm_id")},[]),l=(Array.isArray(i)?i[0]:i)||c||e.discountCommunicationId,p=(0,f.Z)().fetch,v=(n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({},e,(0,d.O)()),o=o={discountCommunicationId:l},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))}),n),b=h(v);return(0,u.useQuery)(b,function(){return m(v,b,p)},t)}},63833:function(e,t){t.Z=function(e){return Number.parseFloat((e/100%1).toPrecision(2))>.98?Math.round(e/100):Math.floor(e/100)}},283242:function(e,t,n){n.d(t,{CP:function(){return s},T3:function(){return p},dN:function(){return b},fO:function(){return v},qR:function(){return h},sj:function(){return f}});var o=n(90104),i=n.n(o),r=n(199729),u=n.n(r),c=n(63833),s=function(e){var t=e.voucher,n=e.index,o=e.subTotal,i=e.addShipping,r=e.shippingAmount,u=e.roundDiscountAmount,c=e.shouldCalculatePercentageAmount,s="Unlimited"===t.discount_settings.lifetime;return a({box:t.discount_settings.discount_rule.box_rule[s?1:n],isPercentageVoucher:"percent"===t.discount_type,subTotal:o,addShipping:i,shippingAmount:r,roundDiscountAmount:u,shouldCalculatePercentageAmount:c})},a=function(e){var t=e.box,n=e.isPercentageVoucher,o=e.subTotal,i=e.addShipping,r=e.shippingAmount,u=e.roundDiscountAmount,s=e.shouldCalculatePercentageAmount;if(!t)return 0;var a=t.discount_value||0;if(o&&n){if(!s)return a;a=a/100*o}if(i){var l=t.applicable_to;if("shipping"===l)return Math.min(a,r);"both"===l&&(a+=r)}return u?100*(0,c.Z)(a):a},l=function(e){if(!e)return!1;var t=e.discount_settings.discount_rule.box_rule;if(i()(t))return!1;var n=t[1].discount_value||0;return!Object.keys(t).every(function(e){return t[e].discount_value===n})},f=function(e){var t=e.repetition_limit;return t?t+(e.repetition_from_first?1:0):"Unlimited"===e.discount_settings.lifetime?52:d(e.discount_settings.discount_rule.box_rule)||e.limit_per_subscription},d=function(e){return Object.keys(e).filter(function(t){var n=e[t];return!!n&&!!n.discount_value}).length},p=function(e){return"Unlimited"===e.discount_settings.lifetime?52:e.discount_settings.box_count},h=function(e){var t=f(e);return(t<=0||t>=52)&&!l(e)},v=function(e,t){var n=e.addShippingOnTotal;return"true"===n||"false"!==n&&u()(t,"notifications.voucher.addShippingOnTotalEnabled")},b=function(e,t,n){return Intl.NumberFormat(t,{style:"currency",currency:n,minimumFractionDigits:e%1==0?0:2,maximumFractionDigits:2}).format(e)}},134930:function(e,t,n){var o=n(152085);t.Z=function(e,t){var n=(0,o.D)({code:e},{suspense:!1}).data;if(!t)return n;if(n){var i=JSON.parse(JSON.stringify(n)),r={},u=null==i?void 0:null===(s=i.discount_settings)||void 0===s?void 0:null===(a=s.discount_rule)||void 0===a?void 0:a.box_rule;for(var c in u){var s,a,l,f=u[c],d=f.discount_sku?function(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o;o=n[t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o})}return e}({},f),{discount_value:(null===(l=f.discount_sku[t])||void 0===l?void 0:l.discount_value)||f.discount_value}):f;delete d.discount_sku,r[c]=d}return i&&(i.discount_settings.discount_rule.box_rule=r),i}}},916767:function(e,t,n){n.d(t,{Z:function(){return _}});var o=n(134930),i=n(283242),r=n(199729),u=n.n(r),c=n(130014),s=n(163273),a=n(686677),l=n(63833),f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:899,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,s=(0,o.Z)(e,r),f=(0,c.z)("website").data,d=(0,a.useRouter)();if(!s||!f)return 0;var h=(0,i.sj)(s),v=u()(f,"notifications.voucher.enableRoundDiscountAmount"),b=0;b=v?(0,l.Z)(b):b/100;var m=0;if((0,i.qR)(s))return p(s,t,n,!1,v);if((0,i.fO)(d.query,f)&&"Unlimited"===s.discount_settings.lifetime&&"products"!==s.discount_settings.discount_rule.box_rule[1].applicable_to)b=52*b*100+(m=5200*(t=v?(0,l.Z)(t):t));else if(s.repetition_rate)b*=h;else{b=0;for(var _=s.discount_settings.discount_rule.box_rule,g=Object.keys(_).length,y=_[1]&&("shipping"===_[1].applicable_to||"both"===_[1].applicable_to),O=(0,i.fO)(d.query,f)&&y,x=O?100*n+t:100*n,j=0;j<g;j++){var w=(0,i.CP)({voucher:s,index:j+1,subTotal:n,addShipping:O,shippingAmount:t,roundDiscountAmount:v});b+=w>=x?x:w}}return b/100},d=function(e,t,n,o){var i=e.discount_value;return i>n?o?n+t/100:n:o?i+t/100:i},p=function(e,t,n,o,i){var r=e.discount_value,u=n;return(o&&(r+=t/100,u=n+t/100),r>u)?u:(i&&(r=(0,l.Z)(100*r)),r)},h=function(e,t,n,r){var l=(0,o.Z)(e,r),f=(0,c.z)("website").data,h=(0,a.useRouter)(),v="1"===(0,s.Y)().hf_ssr_e_gift_card_checkout;if(!l||"fixed"!==l.discount_type||!f)return 0;var b=u()(f,"notifications.voucher.enableRoundDiscountAmount"),m=l.discount_settings.discount_rule.box_rule,_=m[1]&&("shipping"===m[1].applicable_to||"both"===m[1].applicable_to),g=(0,i.fO)(h.query,f)&&_;return v?d(l,t,n,g):p(l,t,n,g,b)},v=function(e,t,n,r,s,l){var f=(0,o.Z)(e,l),d=(0,c.z)("website").data,p=(0,a.useRouter)();if(!f||!d)return 0;var h=u()(d,"notifications.voucher.enableRoundDiscountAmount"),v=f.discount_settings.discount_rule.box_rule,b=v[1]&&("shipping"===v[1].applicable_to||"both"===v[1].applicable_to);return m(f,t,(0,i.fO)(p.query,d)&&b,n,r,s,h)},b=function(e,t,n,r){var s=(0,o.Z)(e,r),f=(0,c.z)("website").data,d=(0,a.useRouter)();if(!s||!f)return 0;var p=u()(f,"notifications.voucher.enableRoundDiscountAmount"),h=0;if((0,i.qR)(s))return(0,l.Z)(m(s,n,!1,100*t));for(var v=s.discount_settings.discount_rule.box_rule,b=Object.keys(v).length,_=v[1]&&("shipping"===v[1].applicable_to||"both"===v[1].applicable_to),g=(0,i.fO)(d.query,f)&&_,y=g?100*t+n:100*t,O=0;O<b;O++){var x=(0,i.CP)({voucher:s,index:O+1,subTotal:t,addShipping:g,shippingAmount:n,roundDiscountAmount:p,shouldCalculatePercentageAmount:!0});h+=x>=y?y:x}return h/100},m=function(e,t,n,o,i,r,u){var c=e.discount_value,s=e.discount_settings.discount_rule.box_rule;if(1===Object.keys(s).length&&(c=s[1].discount_value/100),!o)return c;var a=o*(c/100);return(n&&(a+=t/100),!i&&o&&r&&a>=100*o)?o-a:(u&&(a=(0,l.Z)(100*a)),a)},_=function(e,t,n,r,u,c){var s=(0,o.Z)(e,r),a=h(e,t,n,r),l=f(e,t,n,r),d=v(e,t,n,c,u,r),p=b(e,n,t,r);if(!s)return 0;var m="fixed"===s.discount_type,_="percent"===s.discount_type,g=(0,i.sj)(s)>1,y=0;return m&&(y=g?l:a),_&&(y=g?p:d),y}},899990:function(e,t,n){n.d(t,{Z:function(){return S}});var o=n(199729),i=n.n(o),r=n(427795),u=n(102097),c=n(130014),s=n(283242),a=n(827378),l=n(567921),f=n.n(l),d=n(686677),p=function(e){var t,n,o,r=(0,d.useRouter)(),u=(0,c.z)("website").data,s=i()(u,"newFeatures.displayFreeMealsDefault"),l=(0,a.useMemo)(function(){return f().get("hf_dm_meals")},[]),p=(0,a.useMemo)(function(){return f().get("hf_dm_gifts")},[]),h=(0,a.useMemo)(function(){return f().get("hf_dm_custom")},[]),v=(0,a.useMemo)(function(){return f().get("hf_dm_dollars")},[]),b=(0,a.useMemo)(function(){return f().get("hf_dm_box")},[]),m=r.query.dm||l,_=r.query.dm_gifts||p,g=r.query.dm_custom||h,y=r.query.dm_dollars||v,O=r.query.dm||b;return(0,a.useEffect)(function(){!l&&m&&f().set("hf_dm_meals",m)},[l,m]),(0,a.useEffect)(function(){!v&&y&&f().set("hf_dm_dollars",y)},[v,y]),(0,a.useEffect)(function(){!p&&_&&f().set("hf_dm_gifts",_)},[p,_]),(0,a.useEffect)(function(){!h&&g&&f().set("hf_dm_custom",g)},[h,g]),(0,a.useEffect)(function(){!b&&O&&f().set("hf_dm_box",O)},[b,O]),{displayMeals:"meals"===m||"true"!==y&&s,displayServings:"servings"===m,displayFirstBoxMeals:"first-box-meals"===m,displayFreeGifts:"gifts"===_,displayTote:"tote"===g,displayDollarsOff:"true"===y,displayFreeBox:(n="free-box"===O,o=!!(null===(t=r.query.utm_couponvalue)||void 0===t?void 0:t.includes("165")),n&&!!e&&e<=95&&!o),displayBuyOneGetOne:"buy1get1"===m,displayAmazonGiftCard:"zon"===g}},h=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return(o?Math.floor(e/(t/n)):Math.round(e/(t/n)))||0},v=n(916767),b=n(134930),m=n(163273),_=n(90104),g=n.n(_),y=function(e){var t=e.discount_settings.discount_rule.box_rule,n=t[1]&&("shipping"===t[1].applicable_to||"both"===t[1].applicable_to),o=Object.keys(t).filter(function(e,t){return"0"!==t.toString()}).every(function(e){return"products"===t[e].applicable_to});return n&&o},O=function(e,t,n,o){var i=n?"fixed":e.discount_type,r=!g()(e.discount_settings.discount_rule.box_rule),u=x(e),c=y(e),a=(0,s.qR)(e)?"permanent":"semi-permanent",l="";return(r&&(u&&(l="senf-notification.voucher.".concat(i,".").concat(a,".free-shipping-all")),c&&(l="senf-notification.voucher.".concat(i,".").concat(a,".free-shipping-first"))),l&&t(l))?l:o?"senf-notification.voucher.replacement.fixed.new-year-offer":"senf-notification.voucher.".concat(i,".").concat(a)},x=function(e){var t=e.discount_settings.discount_rule.box_rule,n=(0,s.T3)(e)===(0,s.sj)(e),o=Object.keys(t).every(function(e){var n=t[e];return"shipping"===n.applicable_to||"both"===n.applicable_to});return n&&o},j=n(101518),w=function(e,t,n,o,u){var l=(0,b.Z)(e,t),d=(0,r.Z)("senf-notification").translateRaw,h=p(n),v=h.displayMeals,_=h.displayServings,g=h.displayFirstBoxMeals,y=h.displayFreeGifts,x=h.displayTote,w=h.displayFreeBox,P=h.displayDollarsOff,S=h.displayBuyOneGetOne,A=h.displayAmazonGiftCard,D=(0,j.Z)(),k=(0,m.Y)(),C=(0,c.z)("website").data,Z="1"===k.hf_ssr_e_gift_card_checkout,M=(0,a.useMemo)(function(){return f().get("hf_ssr_e_free_breakfast_for_life")},[]),R=[],q="";if(!l)return R;var F=null==u?void 0:u.isEnabled,T=null==u?void 0:u.codes,E=null==T?void 0:T.find(function(e){return e.code===l.code});if(F&&E)return[E.applangaKey];if("Checkout Alternate"===l.channel)return["senf-notification.voucher.checkout-alternate"];if(w)q="senf-notification.voucher.free-box";else{var z=(0,s.qR)(l),B=1===(0,s.sj)(l),N=(0,s.sj)(l)>1;switch(!0){case N:case z:q=O(l,d,P,o);break;case B:q="percent"===l.discount_type?"senf-notification.voucher.percent.first-order":"senf-notification.voucher.fixed.first-order"}if(v){if("US"===D)return q="senf-notification.voucher.display-meals.variation_1",R.push(q),M&&R.push("senf-notification.voucher.".concat(M)),R;q="senf-notification.voucher.display-meals"}_&&(q="senf-notification.voucher.display-servings"),g&&(q="senf-notification.voucher.display-first-box-meals"),Z&&(q="senf-notification.voucher.gift-card"),S&&(q="senf-notification.voucher.buy-one-message")}return R.push(q),e===i()(C,"notifications.voucher.experimentCodes.replacementVoucher")&&R.unshift("senf-notification.voucher.replacement-funnel"),o&&R.unshift("senf-notification.voucher.replacement-prefix-limited-time-offer"),y&&R.push("senf-notification.voucher.gift-message"),x&&R.push("senf-notification.voucher.tote-message"),A&&R.push("senf-notification.voucher.amazon-message"),M&&R.push("senf-notification.voucher.".concat(M)),R},P=n(63833),S=function(e,t,n,o,a,l,f){var d,m,_,g=(0,b.Z)(e,a),y=(0,u.Z)(),O=(0,r.Z)("senf-notification").translateRaw,x=(0,c.z)("website").data,j=i()(x,"locale.currency.code"),S=p(),A=S.displayMeals,D=S.displayServings,k=S.displayFirstBoxMeals,C=(0,v.Z)(e,n,t,a),Z=w(e,a,t,l,f);if(!g)return{applangaKey:"",message:""};if("on-site_alternate"===g.channel)return{applangaKey:"senf-notification.voucher.alternate-voucher",message:O("senf-notification.voucher.alternate-voucher",{alternateVoucherDiscount:null==g?void 0:g.discount_value})};(A||k)&&o&&(d=h(C,t,o,i()(x,"notifications.voucher.enableFreeMealRoundDown")));var M=(0,s.CP)({voucher:g,index:1,subTotal:t,addShipping:!1,shippingAmount:n,roundDiscountAmount:!1,shouldCalculatePercentageAmount:!1}),R=(0,s.CP)({voucher:g,index:2,subTotal:t,addShipping:!1,shippingAmount:n,roundDiscountAmount:!1,shouldCalculatePercentageAmount:!1}),q=(0,s.CP)({voucher:g,index:1,subTotal:t,addShipping:!0,shippingAmount:n,roundDiscountAmount:!1,shouldCalculatePercentageAmount:!0});if(D&&o){var F=(0,s.CP)({voucher:g,index:1,subTotal:t,addShipping:!1,shippingAmount:n,roundDiscountAmount:!1,shouldCalculatePercentageAmount:!0});m=(0,s.dN)((t-F/100)/o,y,j)}k&&o&&d&&(_=d-h(q/100,t,o,i()(x,"notifications.voucher.enableFreeMealRoundDown")));var T=(0,s.sj)(g),E=g.repetition_rate&&!g.repetition_from_first,z=(0,s.dN)(C,y,j),B=g.discount_settings.discount_rule.box_rule,N=B[1]&&("shipping"===B[1].applicable_to||"both"===B[1].applicable_to),G=N?(null==g?void 0:g.discount_value)+n/100:null==g?void 0:g.discount_value,I=(0,s.dN)(G,y,j);return{applangaKey:Z.join("|"),message:Z.map(function(e,t){var n=O(e,{amount:z,firstOrder:1===T,totalBoxes:T,ignoreFirst:E,numberOfFreeMeals:d,isFreeShipping:N,totalDiscount:I,pricePerServing:m,firstBoxDiscount:(0,P.Z)(M),secondBoxDiscount:(0,P.Z)(R),remainingMeals:_});return"senf-notification.voucher.expiry-message"!==Z[t+1]||n.endsWith(".")||n.endsWith("!")?n:n.replace(/ +$/,"")+"."}).join(" "),formattedAmount:z}}}}]);